W : constants.go:17 (lib.init.0)             - Couldn't parse CONN_TIMEOUT, using default value:  10m0s
Initializing network for thread:  0
Successfully connected to 10.128.0.26:8020
Connected to socket, listening to party 0
Successfully connected to 10.128.0.5:8060
Connected to socket, listening to party 1
Network for thread 0 complete. 1!: random.go:41 (mpc.InitializePRG)         - Warning: shared_keys_path not set in config. Falling back on deterministic keys (not secure).
1!: mhe.go:25 (mpc.ParallelNetworks.CollectiveInit) - CollectiveInit started
1!: mhe.go:61 (mpc.ParallelNetworks.CollectiveInit) - PubKeyGen
1!: mhe.go:64 (mpc.ParallelNetworks.CollectiveInit) - RelinKeyGen
Pi 256
1!: mhe.go:71 (mpc.ParallelNetworks.CollectiveInit) - RotKeyGen: shifts <= 20 and powers of two up to 8192
Generate RotKey  1 / 212 , Galois element 5
Generate RotKey  2 / 212 , Galois element 25
Generate RotKey  3 / 212 , Galois element 125
Generate RotKey  4 / 212 , Galois element 345
Generate RotKey  5 / 212 , Galois element 625
Generate RotKey  6 / 212 , Galois element 729
Generate RotKey  7 / 212 , Galois element 761
Generate RotKey  8 / 212 , Galois element 1025
Generate RotKey  9 / 212 , Galois element 1281
Generate RotKey  10 / 212 , Galois element 1641
Generate RotKey  11 / 212 , Galois element 1773
Generate RotKey  12 / 212 , Galois element 1817
Generate RotKey  13 / 212 , Galois element 1873
Generate RotKey  14 / 212 , Galois element 1949
Generate RotKey  15 / 212 , Galois element 1953
Generate RotKey  16 / 212 , Galois element 2049
Generate RotKey  17 / 212 , Galois element 2149
Generate RotKey  18 / 212 , Galois element 2501
Generate RotKey  19 / 212 , Galois element 2617
Generate RotKey  20 / 212 , Galois element 2717
Generate RotKey  21 / 212 , Galois element 3125
Generate RotKey  22 / 212 , Galois element 3277
Generate RotKey  23 / 212 , Galois element 3361
Generate RotKey  24 / 212 , Galois element 3473
Generate RotKey  25 / 212 , Galois element 3617
Generate RotKey  26 / 212 , Galois element 3805
Generate RotKey  27 / 212 , Galois element 3881
Generate RotKey  28 / 212 , Galois element 4053
Generate RotKey  29 / 212 , Galois element 4097
Generate RotKey  30 / 212 , Galois element 4413
Generate RotKey  31 / 212 , Galois element 4425
Generate RotKey  32 / 212 , Galois element 4561
Generate RotKey  33 / 212 , Galois element 4989
Generate RotKey  34 / 212 , Galois element 5257
Generate RotKey  35 / 212 , Galois element 5389
Generate RotKey  36 / 212 , Galois element 5613
Generate RotKey  37 / 212 , Galois element 5709
Generate RotKey  38 / 212 , Galois element 5741
Generate RotKey  39 / 212 , Galois element 5809
Generate RotKey  40 / 212 , Galois element 6297
Generate RotKey  41 / 212 , Galois element 6481
Generate RotKey  42 / 212 , Galois element 6853
Generate RotKey  43 / 212 , Galois element 6917
Generate RotKey  44 / 212 , Galois element 7065
Generate RotKey  45 / 212 , Galois element 7069
Generate RotKey  46 / 212 , Galois element 7097
Generate RotKey  47 / 212 , Galois element 7153
Generate RotKey  48 / 212 , Galois element 7277
Generate RotKey  49 / 212 , Galois element 7377
Generate RotKey  50 / 212 , Galois element 7689
Generate RotKey  51 / 212 , Galois element 7937
Generate RotKey  52 / 212 , Galois element 7953
Generate RotKey  53 / 212 , Galois element 7973
Generate RotKey  54 / 212 , Galois element 8009
Generate RotKey  55 / 212 , Galois element 8141
Generate RotKey  56 / 212 , Galois element 8193
Generate RotKey  57 / 212 , Galois element 8205
Generate RotKey  58 / 212 , Galois element 8257
Generate RotKey  59 / 212 , Galois element 8517
Generate RotKey  60 / 212 , Galois element 8561
Generate RotKey  61 / 212 , Galois element 8629
Generate RotKey  62 / 212 , Galois element 8725
Generate RotKey  63 / 212 , Galois element 8869
Generate RotKey  64 / 212 , Galois element 8893
Generate RotKey  65 / 212 , Galois element 9085
Generate RotKey  66 / 212 , Galois element 9253
Generate RotKey  67 / 212 , Galois element 9261
Generate RotKey  68 / 212 , Galois element 9289
Generate RotKey  69 / 212 , Galois element 9745
Generate RotKey  70 / 212 , Galois element 9817
Generate RotKey  71 / 212 , Galois element 9901
Generate RotKey  72 / 212 , Galois element 10205
Generate RotKey  73 / 212 , Galois element 10377
Generate RotKey  74 / 212 , Galois element 10561
Generate RotKey  75 / 212 , Galois element 10745
Generate RotKey  76 / 212 , Galois element 11201
Generate RotKey  77 / 212 , Galois element 11261
Generate RotKey  78 / 212 , Galois element 11653
Generate RotKey  79 / 212 , Galois element 11697
Generate RotKey  80 / 212 , Galois element 11973
Generate RotKey  81 / 212 , Galois element 12021
Generate RotKey  82 / 212 , Galois element 12505
Generate RotKey  83 / 212 , Galois element 12589
Generate RotKey  84 / 212 , Galois element 12593
Generate RotKey  85 / 212 , Galois element 12657
Generate RotKey  86 / 212 , Galois element 12753
Generate RotKey  87 / 212 , Galois element 13069
Generate RotKey  88 / 212 , Galois element 13497
Generate RotKey  89 / 212 , Galois element 13537
Generate RotKey  90 / 212 , Galois element 13813
Generate RotKey  91 / 212 , Galois element 14125
Generate RotKey  92 / 212 , Galois element 14189
Generate RotKey  93 / 212 , Galois element 14249
Generate RotKey  94 / 212 , Galois element 14561
Generate RotKey  95 / 212 , Galois element 14565
Generate RotKey  96 / 212 , Galois element 14613
Generate RotKey  97 / 212 , Galois element 14709
Generate RotKey  98 / 212 , Galois element 14833
Generate RotKey  99 / 212 , Galois element 15049
Generate RotKey  100 / 212 , Galois element 15101
Generate RotKey  101 / 212 , Galois element 15625
Generate RotKey  102 / 212 , Galois element 15721
Generate RotKey  103 / 212 , Galois element 15873
Generate RotKey  104 / 212 , Galois element 15957
Generate RotKey  105 / 212 , Galois element 16049
Generate RotKey  106 / 212 , Galois element 16317
Generate RotKey  107 / 212 , Galois element 16345
Generate RotKey  108 / 212 , Galois element 16357
Generate RotKey  109 / 212 , Galois element 16385
Generate RotKey  110 / 212 , Galois element 16805
Generate RotKey  111 / 212 , Galois element 16841
Generate RotKey  112 / 212 , Galois element 16873
Generate RotKey  113 / 212 , Galois element 16897
Generate RotKey  114 / 212 , Galois element 17365
Generate RotKey  115 / 212 , Galois element 17385
Generate RotKey  116 / 212 , Galois element 17713
Generate RotKey  117 / 212 , Galois element 17797
Generate RotKey  118 / 212 , Galois element 18085
Generate RotKey  119 / 212 , Galois element 18109
Generate RotKey  120 / 212 , Galois element 18489
Generate RotKey  121 / 212 , Galois element 18669
Generate RotKey  122 / 212 , Galois element 18829
Generate RotKey  123 / 212 , Galois element 18961
Generate RotKey  124 / 212 , Galois element 19025
Generate RotKey  125 / 212 , Galois element 19117
Generate RotKey  126 / 212 , Galois element 19173
Generate RotKey  127 / 212 , Galois element 19661
Generate RotKey  128 / 212 , Galois element 19813
Generate RotKey  129 / 212 , Galois element 19861
Generate RotKey  130 / 212 , Galois element 19989
Generate RotKey  131 / 212 , Galois element 20161
Generate RotKey  132 / 212 , Galois element 20333
Generate RotKey  133 / 212 , Galois element 20573
Generate RotKey  134 / 212 , Galois element 20609
Generate RotKey  135 / 212 , Galois element 20713
Generate RotKey  136 / 212 , Galois element 20957
Generate RotKey  137 / 212 , Galois element 21289
Generate RotKey  138 / 212 , Galois element 21473
Generate RotKey  139 / 212 , Galois element 21513
Generate RotKey  140 / 212 , Galois element 21645
Generate RotKey  141 / 212 , Galois element 21649
Generate RotKey  142 / 212 , Galois element 21685
Generate RotKey  143 / 212 , Galois element 21793
Generate RotKey  144 / 212 , Galois element 21929
Generate RotKey  145 / 212 , Galois element 22061
Generate RotKey  146 / 212 , Galois element 22065
Generate RotKey  147 / 212 , Galois element 22129
Generate RotKey  148 / 212 , Galois element 22237
Generate RotKey  149 / 212 , Galois element 22789
Generate RotKey  150 / 212 , Galois element 22805
Generate RotKey  151 / 212 , Galois element 23029
Generate RotKey  152 / 212 , Galois element 23381
Generate RotKey  153 / 212 , Galois element 23481
Generate RotKey  154 / 212 , Galois element 23593
Generate RotKey  155 / 212 , Galois element 23653
Generate RotKey  156 / 212 , Galois element 23673
Generate RotKey  157 / 212 , Galois element 23693
Generate RotKey  158 / 212 , Galois element 24413
Generate RotKey  159 / 212 , Galois element 24577
Generate RotKey  160 / 212 , Galois element 24833
Generate RotKey  161 / 212 , Galois element 24889
Generate RotKey  162 / 212 , Galois element 25217
Generate RotKey  163 / 212 , Galois element 25249
Generate RotKey  164 / 212 , Galois element 25497
Generate RotKey  165 / 212 , Galois element 25717
Generate RotKey  166 / 212 , Galois element 26141
Generate RotKey  167 / 212 , Galois element 26149
Generate RotKey  168 / 212 , Galois element 26209
Generate RotKey  169 / 212 , Galois element 26325
Generate RotKey  170 / 212 , Galois element 26437
Generate RotKey  171 / 212 , Galois element 26505
Generate RotKey  172 / 212 , Galois element 26909
Generate RotKey  173 / 212 , Galois element 27097
Generate RotKey  174 / 212 , Galois element 27241
Generate RotKey  175 / 212 , Galois element 27337
Generate RotKey  176 / 212 , Galois element 27385
Generate RotKey  177 / 212 , Galois element 27725
Generate RotKey  178 / 212 , Galois element 27809
Generate RotKey  179 / 212 , Galois element 27961
Generate RotKey  180 / 212 , Galois element 27981
Generate RotKey  181 / 212 , Galois element 27993
Generate RotKey  182 / 212 , Galois element 28065
Generate RotKey  183 / 212 , Galois element 28225
Generate RotKey  184 / 212 , Galois element 28545
Generate RotKey  185 / 212 , Galois element 28609
Generate RotKey  186 / 212 , Galois element 28673
Generate RotKey  187 / 212 , Galois element 28725
Generate RotKey  188 / 212 , Galois element 29181
Generate RotKey  189 / 212 , Galois element 29189
Generate RotKey  190 / 212 , Galois element 29469
Generate RotKey  191 / 212 , Galois element 29589
Generate RotKey  192 / 212 , Galois element 29637
Generate RotKey  193 / 212 , Galois element 29757
Generate RotKey  194 / 212 , Galois element 30049
Generate RotKey  195 / 212 , Galois element 30177
Generate RotKey  196 / 212 , Galois element 30281
Generate RotKey  197 / 212 , Galois element 30329
Generate RotKey  198 / 212 , Galois element 30517
Generate RotKey  199 / 212 , Galois element 30653
Generate RotKey  200 / 212 , Galois element 30721
Generate RotKey  201 / 212 , Galois element 30933
Generate RotKey  202 / 212 , Galois element 30953
Generate RotKey  203 / 212 , Galois element 31257
Generate RotKey  204 / 212 , Galois element 31349
Generate RotKey  205 / 212 , Galois element 31745
Generate RotKey  206 / 212 , Galois element 31813
Generate RotKey  207 / 212 , Galois element 32401
Generate RotKey  208 / 212 , Galois element 32405
Generate RotKey  209 / 212 , Galois element 32501
Generate RotKey  210 / 212 , Galois element 32573
Generate RotKey  211 / 212 , Galois element 32577
Generate RotKey  212 / 212 , Galois element 32767
1!: mhe.go:78 (mpc.ParallelNetworks.CollectiveInit) - CollectiveInit finished
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Encryption time:  30.383029ms
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Encoding time:  6.522536ms
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Addition time:  807.667µs
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Addition with plain time:  802.197µs
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Rotation time:  39.599907ms
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Multiplication with plain time:  8.08397ms
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Multiplication time:  47.573576ms
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Multiplication with scalar time:  48.603861ms
Network log for party 2
0 bytes to party 1
0 bytes from party 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Inner sum & Duplicate time:  522.133976ms
Network log for party 2
8 bytes to party 0
2621468 bytes to party 1
5242923 bytes from party 1
8 bytes from party 0
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Decryption time:  487.572122ms
Network log for party 2
2621532 bytes to party 1
8 bytes to party 0
5243019 bytes from party 1
8 bytes from party 0
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Bootstrapping time:  575.171959ms
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
Network log for party 2
2621479 bytes to party 1
8 bytes to party 0
2621487 bytes from party 1
8 bytes from party 0
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: aggregate.go:496 (mpc.(*Network).AggregateCMat) - [[0xc00059e6d0]] 1
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Aggregation time:  165.873329ms
Network log for party 2
8 bytes to party 0
16 bytes to party 1
8 bytes from party 1
8 bytes from party 0
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Sigmoid time:  305.063096ms
Network log for party 2
1310742 bytes to party 1
8 bytes to party 0
3932213 bytes from party 1
8 bytes from party 0
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Switch to MPC time:  797.055011ms
Network log for party 2
8 bytes to party 0
36045392 bytes to party 1
36045384 bytes from party 1
44892688 bytes from party 0
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Inverse sqrt time:  24.437412857s
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:16:06Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
Network log for party 2
25559472 bytes to party 1
8 bytes to party 0
25559464 bytes from party 1
40174024 bytes from party 0
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:16:24Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:16:42Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:17:00Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:17:18Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:17:36Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:17:54Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:18:12Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:18:30Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: mpc.go:2083 (mpc.(*MPC).Divide)          - 2024-07-16T15:18:48Z MPC Divide called (n = 8192) divSqrtMaxLen 10000
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Divide time:  17.968823754s
Network log for party 2
2687096 bytes to party 1
8 bytes to party 0
2687088 bytes from party 1
2424920 bytes from party 0
1!: microBenchmark_test.go:79 (gwas.TestMicroBenchmark.func1) - 2  Compare time:  4.131266759s
EigenDecomp: 15-th eigenvalue
EigenDecomp: 14-th eigenvalue
EigenDecomp: 13-th eigenvalue
EigenDecomp: 12-th eigenvalue
EigenDecomp: 11-th eigenvalue
EigenDecomp: 10-th eigenvalue
EigenDecomp: 9-th eigenvalue
EigenDecomp: 8-th eigenvalue
EigenDecomp: 7-th eigenvalue
EigenDecomp: 6-th eigenvalue
EigenDecomp: 5-th eigenvalue
EigenDecomp: 4-th eigenvalue
EigenDecomp: 3-th eigenvalue
EigenDecomp: 2-th eigenvalue
EigenDecomp: 1-th eigenvalue
EigenDecomp: complete
Network log for party 2
17195156 bytes to party 1
8 bytes to party 0
21201868 bytes from party 0
17195148 bytes from party 1
--- FAIL: TestMicroBenchmark (20116.81s)
panic: EOF [recovered]
	panic: EOF

goroutine 35 [running]:
testing.tRunner.func1.2({0x6891a0, 0x90a270})
	/usr/local/go/src/testing/testing.go:1545 +0x238
testing.tRunner.func1()
	/usr/local/go/src/testing/testing.go:1548 +0x397
panic({0x6891a0?, 0x90a270?})
	/usr/local/go/src/runtime/panic.go:914 +0x21f
github.com/hhcho/sfgwas/mpc.ReadFull(0xc00022e7e8, {0xc024526d44, 0x4, 0x4})
	/home/dfroelic/sfgwas/mpc/netconnect.go:268 +0xd3
github.com/hhcho/sfgwas/mpc.(*Network).ReceiveRMat(0xc000133960, {0x75e1d8, 0xc024526d00}, 0xc00022e8e8?, 0x57245f?, 0xc00022e8e8?)
	/home/dfroelic/sfgwas/mpc/sendrecieve.go:383 +0x96
github.com/hhcho/sfgwas/mpc.(*MPC).RevealSymMat(0xc000134600, {0xc003245d40?, 0x4, 0x4})
	/home/dfroelic/sfgwas/mpc/mpc.go:406 +0x1f8
github.com/hhcho/sfgwas/mpc.(*MPC).BeaverPartitionMat(0xc000134600, {0xc003245c80?, 0x4, 0x4})
	/home/dfroelic/sfgwas/mpc/beavermult.go:45 +0x20e
github.com/hhcho/sfgwas/mpc.(*MPC).BinaryPrefixOr(0xc000134600, {0xc0032452c0?, 0x4, 0x4}, 0x100)
	/home/dfroelic/sfgwas/mpc/mpc.go:1221 +0xcf4
github.com/hhcho/sfgwas/mpc.(*MPC).NormalizerEvenExp2N(0xc000134600, {0xc00022f3b8, 0x1, 0x9?}, 0x3c)
	/home/dfroelic/sfgwas/mpc/mpc.go:956 +0x8f6
github.com/hhcho/sfgwas/mpc.(*MPC).SqrtAndSqrtInverse(0xc000134600, {0xc00022f3b8, 0x1, 0x1}, 0x1)
	/home/dfroelic/sfgwas/mpc/mpc.go:2027 +0x153
github.com/hhcho/sfgwas/mpc.(*MPC).Householder(0xc000134600, {0xc0001560c0, 0xc, 0xd?})
	/home/dfroelic/sfgwas/mpc/mpc.go:2293 +0x43d
github.com/hhcho/sfgwas/mpc.(*MPC).Tridiag(0xc000134600, {0xc22b434000?, 0x10, 0x10})
	/home/dfroelic/sfgwas/mpc/mpc.go:2445 +0x275
github.com/hhcho/sfgwas/mpc.(*MPC).EigenDecomp(0xc000134600, {0xc22b434000?, 0x10, 0x10})
	/home/dfroelic/sfgwas/mpc/mpc.go:2569 +0x165
github.com/hhcho/sfgwas/gwas.TestMicroBenchmark.func19()
	/home/dfroelic/sfgwas/gwas/microBenchmark_test.go:234 +0x7a
github.com/hhcho/sfgwas/gwas.TestMicroBenchmark.func1(0xc00024fd60, {0x6e793c, 0x13})
	/home/dfroelic/sfgwas/gwas/microBenchmark_test.go:72 +0x163
github.com/hhcho/sfgwas/gwas.TestMicroBenchmark(0x0?)
	/home/dfroelic/sfgwas/gwas/microBenchmark_test.go:232 +0x1326
testing.tRunner(0xc000105860, 0x710468)
	/usr/local/go/src/testing/testing.go:1595 +0xff
created by testing.(*T).Run in goroutine 1
	/usr/local/go/src/testing/testing.go:1648 +0x3ad
exit status 2
FAIL	github.com/hhcho/sfgwas/gwas	20116.851s
